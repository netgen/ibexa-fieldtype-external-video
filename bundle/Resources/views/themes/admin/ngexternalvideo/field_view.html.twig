{% extends '@IbexaCore/content_fields.html.twig' %}

{% trans_default_domain 'field_view' %}

{% block ngexternalvideo_field %}
    {% apply spaceless %}
        {% if not ibexa_field_is_empty(content, field) %}
            {% set attr = attr|merge({'class': (attr.class|default('') ~ ' ibexa-field-preview ibexa-field-preview--ngexternalvideo')|trim}) %}
            <div {{ block('field_attributes') }}>
                {% set token = app.request.server.get('CLOUDFLARE_BEARER_TOKEN') %}
                {% set url = app.request.server.get('CLOUDFLARE_API_URL') %}
                <div id="data-api" data-url="{{ url~field.value.id }}" data-token="{{ token }}" style="display: none;"></div>
                <p>Source: {{ field.value.source }}</p>
                <p>ID: {{ field.value.id }}</p>
                <p id="video_name"></p>
                <p id="video_duration"></p>
                <p id="video_resolution"></p>
                <p id="video_date_uploaded"></p>
                <img id="video_thumbnail_image"/>
            </div>
        {% endif %}
    {% endapply %}
{% endblock %}

{% block field_attributes %}
    {% apply spaceless %}
        {% set attr = attr|default({}) %}
        {% for attrname, attrvalue in attr %}{{ attrname }}="{{ attrvalue }}" {% endfor %}
    {% endapply %}
{% endblock %}
